
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   <!--
This HTML was auto-generated from MATLAB code.
To make changes, update the MATLAB code and republish this document.
      --><title>Lab 3 de MVO 31 - Voo Horizontal em Curva</title><meta name="generator" content="MATLAB 9.2"><link rel="schema.DC" href="http://purl.org/dc/elements/1.1/"><meta name="DC.date" content="2019-06-02"><meta name="DC.source" content="Lab3.m"><style type="text/css">
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{margin:0;padding:0;border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent}body{line-height:1}ol,ul{list-style:none}blockquote,q{quotes:none}blockquote:before,blockquote:after,q:before,q:after{content:'';content:none}:focus{outine:0}ins{text-decoration:none}del{text-decoration:line-through}table{border-collapse:collapse;border-spacing:0}

html { min-height:100%; margin-bottom:1px; }
html body { height:100%; margin:0px; font-family:Arial, Helvetica, sans-serif; font-size:10px; color:#000; line-height:140%; background:#fff none; overflow-y:scroll; }
html body td { vertical-align:top; text-align:left; }

h1 { padding:0px; margin:0px 0px 25px; font-family:Arial, Helvetica, sans-serif; font-size:1.5em; color:#d55000; line-height:100%; font-weight:normal; }
h2 { padding:0px; margin:0px 0px 8px; font-family:Arial, Helvetica, sans-serif; font-size:1.2em; color:#000; font-weight:bold; line-height:140%; border-bottom:1px solid #d6d4d4; display:block; }
h3 { padding:0px; margin:0px 0px 5px; font-family:Arial, Helvetica, sans-serif; font-size:1.1em; color:#000; font-weight:bold; line-height:140%; }

a { color:#005fce; text-decoration:none; }
a:hover { color:#005fce; text-decoration:underline; }
a:visited { color:#004aa0; text-decoration:none; }

p { padding:0px; margin:0px 0px 20px; }
img { padding:0px; margin:0px 0px 20px; border:none; }
p img, pre img, tt img, li img, h1 img, h2 img { margin-bottom:0px; } 

ul { padding:0px; margin:0px 0px 20px 23px; list-style:square; }
ul li { padding:0px; margin:0px 0px 7px 0px; }
ul li ul { padding:5px 0px 0px; margin:0px 0px 7px 23px; }
ul li ol li { list-style:decimal; }
ol { padding:0px; margin:0px 0px 20px 0px; list-style:decimal; }
ol li { padding:0px; margin:0px 0px 7px 23px; list-style-type:decimal; }
ol li ol { padding:5px 0px 0px; margin:0px 0px 7px 0px; }
ol li ol li { list-style-type:lower-alpha; }
ol li ul { padding-top:7px; }
ol li ul li { list-style:square; }

.content { font-size:1.2em; line-height:140%; padding: 20px; }

pre, code { font-size:12px; }
tt { font-size: 1.2em; }
pre { margin:0px 0px 20px; }
pre.codeinput { padding:10px; border:1px solid #d3d3d3; background:#f7f7f7; }
pre.codeoutput { padding:10px 11px; margin:0px 0px 20px; color:#4c4c4c; }
pre.error { color:red; }

@media print { pre.codeinput, pre.codeoutput { word-wrap:break-word; width:100%; } }

span.keyword { color:#0000FF }
span.comment { color:#228B22 }
span.string { color:#A020F0 }
span.untermstring { color:#B20000 }
span.syscmd { color:#B28C00 }

.footer { width:auto; padding:10px 0px; margin:25px 0px 0px; border-top:1px dotted #878787; font-size:0.8em; line-height:140%; font-style:italic; color:#878787; text-align:left; float:none; }
.footer p { margin:0px; }
.footer a { color:#878787; }
.footer a:hover { color:#878787; text-decoration:underline; }
.footer a:visited { color:#878787; }

table th { padding:7px 5px; text-align:left; vertical-align:middle; border: 1px solid #d6d4d4; font-weight:bold; }
table td { padding:7px 5px; text-align:left; vertical-align:top; border:1px solid #d6d4d4; }





  </style></head><body><div class="content"><h1>Lab 3 de MVO 31 - Voo Horizontal em Curva</h1><!--introduction--><p>C&oacute;digo para solu&ccedil;&atilde;o das equa&ccedil;&otilde;es do Laborat&oacute;rio 3 de MVO-31. No fim do c&oacute;digo ha algumas linhas de c&oacute;digo comentadas que geram a vers&atilde;o publicada do c&oacute;digo, para facilitar a corre&ccedil;&atilde;o. Para isso, basta copiar os comandos comentados na Command Window e apertar enter.                                   Autor: Francisco Arthur Bonfim Azevedo</p><!--/introduction--><h2>Contents</h2><div><ul><li><a href="#1">Parametros da Aeronave</a></li><li><a href="#2">item 1</a></li><li><a href="#3">item 2</a></li><li><a href="#4">Item 3</a></li><li><a href="#5">Item 4</a></li><li><a href="#6">Item 5</a></li><li><a href="#7">Item 6</a></li><li><a href="#8">Item 7</a></li><li><a href="#9">Gera a vers&atilde;o html do c&oacute;digo</a></li></ul></div><h2 id="1">Parametros da Aeronave</h2><pre class="codeinput">W =  33100*9.81;<span class="comment">% kg</span>
s = 88;<span class="comment">% m2</span>
Tmax_s = 55600; <span class="comment">%N</span>


T = @(delt,rho) delt*(rho./1.225).^0.6*Tmax_s; <span class="comment">%W</span>
Cd0 = 0.015;
k = 0.05;

CD =@(CL) Cd0 + k*CL^2;

CLmax = 2.8;
CL =@(alfa) 0.02 + 0.12*alfa;
CM =@(alfa,delta_profund) 0.24 - 0.18*alfa + 0.28*delta_profund;
nmax = 2;

VmaxOper = 247;<span class="comment">% m/s</span>

options = optimoptions(<span class="string">'fsolve'</span>,<span class="string">'Display'</span>,<span class="string">'none'</span>);
</pre><h2 id="2">item 1</h2><pre class="codeinput">phi = deg2rad(30);
[~,~,~,rho] = atmosisa(3000);
Vel = linspace(40,VmaxOper,1000);
Vstall = sqrt(2*W/(rho*s*CLmax));
Treq =  0.5*rho*Vel.^2*s*Cd0+2*k*W^2./(rho*Vel.^2*s*cos(phi)^2);

figure
plot(Vel,Treq)
hold <span class="string">on</span>
grid <span class="string">on</span>
plot(Vstall*ones(1,1000), linspace(0,max(Treq),1000),<span class="string">'--k'</span>)
hold <span class="string">off</span>
xlabel(<span class="string">'Velocidade [m/s]'</span>)
ylabel(<span class="string">'Tra&ccedil;&atilde;o [N]'</span>)
title(<span class="string">'Gr&aacute;fico da Tra&ccedil;&atilde;o requerida numa dada velocidade'</span>);
legend(<span class="string">'Tra&ccedil;&atilde;o requerida'</span>,<span class="string">'Velocidade de estol'</span>);
</pre><img vspace="5" hspace="5" src="Lab3_01.png" alt=""> <h2 id="3">item 2</h2><p>Caso da formula de tra&ccedil;&atilde;o minima</p><pre class="codeinput">VtracMin = sqrt((2*W/(rho*s))*sqrt(k/(Cd0*cos(phi)^2)))
TracMinTeo = 2*W*sqrt(k*Cd0/(cos(phi)^2))

<span class="comment">% raio de curva</span>
RtracMin = VtracMin^2/(9.81*tan(phi))

<span class="comment">% velocidade angular</span>
OmegaTracMin = VtracMin/RtracMin

<span class="comment">% per&iacute;odo necess&aacute;rio</span>
Period = 2*pi/OmegaTracMin

<span class="comment">% angulo de ataque</span>
CLTracMin = W/(0.5*rho*VtracMin^2*s*cos(phi));
alfaTracMin = fsolve(@(alfa) CL(alfa) - CLTracMin,0.5,options)

<span class="comment">% Deflex&atilde;o de profundor</span>
deflexProfundTracMin = fsolve(@(delta) CM(alfaTracMin,delta),0.5,options)

<span class="comment">% Posi&ccedil;&atilde;o de manete</span>
PosicManeteTracMin = fsolve(@(delta) T(delta,rho)-TracMinTeo,10^5,options)
</pre><pre class="codeoutput">
VtracMin =

  130.8174


TracMinTeo =

   2.0537e+04


RtracMin =

   3.0215e+03


OmegaTracMin =

    0.0433


Period =

  145.1232


alfaTracMin =

    4.3977


deflexProfundTracMin =

    1.9699


PosicManeteTracMin =

    0.4417

</pre><h2 id="4">Item 3</h2><pre class="codeinput">poli = [0.5*rho*s*Cd0 0 (-(rho/1.225)^0.6*Tmax_s) 0 2*k*W^2/(rho*s*cos(phi)^2)];
VMaxMin = sort(roots(poli),<span class="string">'descend'</span>);
Vmin = VMaxMin(2,1);
Vmax = VMaxMin(1,1)

<span class="comment">% raio de curva</span>
Rvmax = Vmax^2/(9.81*tan(phi))

<span class="comment">% velocidade angular</span>
OmegaVmax = Vmax/Rvmax

<span class="comment">% per&iacute;odo necess&aacute;rio</span>
PeriodVmax = 2*pi/OmegaVmax

<span class="comment">% angulo de ataque</span>
CLVelMax = W/(0.5*rho*Vmax^2*s*cos(phi));
alfaVelMax = fsolve(@(alfa) CL(alfa) - CLVelMax,0.5,options)

<span class="comment">% Deflex&atilde;o de profundor</span>
deflexProfundVelMax = fsolve(@(delta)CM(alfaVelMax,delta),0.5,options)
</pre><pre class="codeoutput">
Vmax =

  271.1038


Rvmax =

   1.2977e+04


OmegaVmax =

    0.0209


PeriodVmax =

  300.7510


alfaVelMax =

    0.8961


deflexProfundVelMax =

   -0.2811

</pre><h2 id="5">Item 4</h2><pre class="codeinput">Vstall = sqrt(2*W/(rho*s*CLmax));

<span class="keyword">if</span> Vmin &lt; Vstall
    Vmin = Vstall;
<span class="keyword">end</span>

Vmin

<span class="comment">% raio de curva</span>
Rvmin = Vmin^2/(9.81*tan(phi))

<span class="comment">% velocidade angular</span>
OmegaVmin = Vmin/Rvmin

<span class="comment">% per&iacute;odo necess&aacute;rio</span>
PeriodVmin = 2*pi/OmegaVmin

<span class="comment">% angulo de ataque</span>
CLVelMin = W/(0.5*rho*Vmin^2*s*cos(phi));
alfaVelMin = fsolve(@(alfa) CL(alfa) - CLVelMin,0.5,options)

<span class="comment">% Deflex&atilde;o de profundor</span>
deflexProfundVelMin = fsolve(@(delta)CM(alfaVelMin,delta),0.5,options)
</pre><pre class="codeoutput">
Vmin =

   63.1241


Rvmin =

  703.5293


OmegaVmin =

    0.0897


PeriodVmin =

   70.0272


alfaVelMin =

   19.4362


deflexProfundVelMin =

   11.6376

</pre><h2 id="6">Item 5</h2><pre class="codeinput">TetoVoo = @(rhoTeto) 2*W*sqrt(Cd0*k)/cos(phi) - T(1,rhoTeto);

rhoTeto = fsolve(TetoVoo, 0.1,options);

HtetoAux = 12000:.05:15000;
[~,~,~,rhoTetoAux] = atmosisa(HtetoAux);
rhoTetoAuxPosic = find(abs(rhoTetoAux - rhoTeto) &lt; 10^-4);
Hteto = HtetoAux(rhoTetoAuxPosic(1,1))
clear <span class="string">HtetoAux</span> <span class="string">rhoTetoAux</span> <span class="string">rhoTetoAuxPosic</span>
</pre><pre class="codeoutput">
Hteto =

   1.3827e+04

</pre><h2 id="7">Item 6</h2><pre class="codeinput">HEnvel = linspace(0,0.9999*Hteto,100);
[~,~,~,rhoEnvel] = atmosisa(HEnvel);
rhoEnvel = rhoEnvel';


PoliVreq = [0.5*rhoEnvel*s*Cd0, zeros(length(rhoEnvel),1),  (- T(1,rhoEnvel)), zeros(length(rhoEnvel),1), 2*k*W^2./(rhoEnvel*s*cos(phi)^2)];

Vreq = zeros(length(rhoEnvel),1);
Vreq2 = zeros(length(rhoEnvel),1);

<span class="keyword">for</span> i = 1:length(rhoEnvel)
VreqAux = sort(roots(PoliVreq(i,:)),<span class="string">'descend'</span>);
Vreq(i) = VreqAux(1,1);
Vreq2(i) = VreqAux(2,1);
<span class="keyword">end</span>

HEnvel = [ HEnvel HEnvel(sort(1:1:length(HEnvel),<span class="string">'descend'</span>))];
Vreq = [ (Vreq2)' (Vreq(sort(1:1:length(Vreq),<span class="string">'descend'</span>)))' ];
Vstall = sqrt(2*W./(rhoEnvel*s*CLmax));


color = HEnvel;

figure
patch(Vreq,HEnvel,color)
hold <span class="string">on</span>
colorbar
plot(Vstall, HEnvel(1,1:100),<span class="string">'LineWidth'</span>,2)
xlabel(<span class="string">'Velocidade [m/s]'</span>)
ylabel(<span class="string">'Altitude da aeronave [m]'</span>)
title(<span class="string">'Envelope de voo da aeronave'</span>)
grid <span class="string">on</span>
hold <span class="string">off</span>
</pre><img vspace="5" hspace="5" src="Lab3_02.png" alt=""> <h2 id="8">Item 7</h2><pre class="codeinput">Vel = linspace(0,VmaxOper,1000);


[~,~,~,rho] = atmosisa(3000);

<span class="comment">%limite do cosseno:</span>
cosMax = 1*ones(1,length(Vel));

<span class="comment">%limite de velocidade:</span>
Vstall = sqrt(2*W/(rho*s*CLmax))*ones(1,length(Vel));

<span class="comment">%limite estrutural:</span>
cosPhiMaxEstrutural = (1/nmax)*ones(1,length(Vel));

<span class="comment">%limite aerodin&acirc;mico:</span>
cosPhiMaxAerodinamico = 2*W./(rho.*Vel.^2*s*CLmax).*(2*W./(rho.*Vel.^2*s*CLmax)&lt;1); <span class="comment">%a desigualdade limita a valor do cosseno entre 0 e 1</span>

<span class="comment">%limite propulsivo:</span>
cosPhiMaxPropulsivo = (2*k*W^2./(2*Vel.^2*s))./(-0.5*rho.*Vel.^2*s*Cd0 + T(1,rho)).*((2*k*W^2./(2*Vel.^2*s))./(-0.5*rho.*Vel.^2*s*Cd0 + T(1,rho))&lt;1); <span class="comment">%a desigualdade limita a valor do cosseno entre 0 e 1</span>

m1 = min(find(cosPhiMaxEstrutural&gt;0)); <span class="comment">%Remove os zeros que existem repetidos no vetor</span>

m2 = min(find(cosPhiMaxAerodinamico&gt;0));

m3 = min(find(cosPhiMaxPropulsivo&gt;0));

figure
plot(Vel,cosMax,<span class="string">'--r'</span>)
hold <span class="string">on</span>
grid <span class="string">on</span>
plot(Vel(1,m1:end),cosPhiMaxEstrutural(1,m1:end))
plot(Vel(1,m2:end),cosPhiMaxAerodinamico(1,m2:end))
plot(Vel(1,m3:end),cosPhiMaxPropulsivo(1,m3:end))
plot(Vstall,linspace(0,1,length(Vstall)),<span class="string">'--k'</span>)
text(76.15,0.5,<span class="string">'\leftarrow Ponto de raio minimo'</span>)
plot(76.15,0.5,<span class="string">'or'</span>)
text(150,0.7,<span class="string">'Regi&atilde;o permitida'</span>)
hold <span class="string">off</span>
ylim([0 1.1])
xlabel(<span class="string">'Velocidade [m/s]'</span>)
ylabel(<span class="string">'cos(\phi)'</span>)
title(<span class="string">'Gr&aacute;fico da Tra&ccedil;&atilde;o requerida numa dada velocidade'</span>);
legend(<span class="string">'Limite do cosseno'</span>,<span class="string">'Limite estrutural'</span>, <span class="string">'Limite aerodin&acirc;mico'</span>, <span class="string">'Limite propulsivo'</span>,<span class="string">'Velocidade de estol'</span>);


VRaioMin = 76.15;
phiRaioMin = acos(0.5);
Rmin = VRaioMin^2/(9.81*tan(phiRaioMin))
</pre><pre class="codeoutput">
Rmin =

  341.2795

</pre><img vspace="5" hspace="5" src="Lab3_03.png" alt=""> <h2 id="9">Gera a vers&atilde;o html do c&oacute;digo</h2><pre>   publish('Lab3.m');
   web('html/Lab3.html');</pre><p class="footer"><br><a href="http://www.mathworks.com/products/matlab/">Published with MATLAB&reg; R2017a</a><br></p></div><!--
##### SOURCE BEGIN #####
%% Lab 3 de MVO 31 - Voo Horizontal em Curva
% Código para solução das equações do Laboratório 3 de MVO-31.
% No fim do código ha algumas linhas de código comentadas que geram a 
% versão publicada do código, para facilitar a correção.
% Para isso, basta copiar os comandos comentados na Command Window e
% apertar enter.
%                                   Autor: Francisco Arthur Bonfim Azevedo


%% Parametros da Aeronave
W =  33100*9.81;% kg
s = 88;% m2
Tmax_s = 55600; %N


T = @(delt,rho) delt*(rho./1.225).^0.6*Tmax_s; %W
Cd0 = 0.015;
k = 0.05;

CD =@(CL) Cd0 + k*CL^2;

CLmax = 2.8;
CL =@(alfa) 0.02 + 0.12*alfa;
CM =@(alfa,delta_profund) 0.24 - 0.18*alfa + 0.28*delta_profund;
nmax = 2;

VmaxOper = 247;% m/s

options = optimoptions('fsolve','Display','none');

%% item 1
phi = deg2rad(30);
[~,~,~,rho] = atmosisa(3000);
Vel = linspace(40,VmaxOper,1000);
Vstall = sqrt(2*W/(rho*s*CLmax));
Treq =  0.5*rho*Vel.^2*s*Cd0+2*k*W^2./(rho*Vel.^2*s*cos(phi)^2);

figure
plot(Vel,Treq)
hold on
grid on
plot(Vstall*ones(1,1000), linspace(0,max(Treq),1000),'REPLACE_WITH_DASH_DASHk')
hold off
xlabel('Velocidade [m/s]')
ylabel('Tração [N]')
title('Gráfico da Tração requerida numa dada velocidade');
legend('Tração requerida','Velocidade de estol');

%% item 2
% Caso da formula de tração minima
VtracMin = sqrt((2*W/(rho*s))*sqrt(k/(Cd0*cos(phi)^2)))
TracMinTeo = 2*W*sqrt(k*Cd0/(cos(phi)^2))

% raio de curva
RtracMin = VtracMin^2/(9.81*tan(phi))

% velocidade angular
OmegaTracMin = VtracMin/RtracMin

% período necessário
Period = 2*pi/OmegaTracMin

% angulo de ataque
CLTracMin = W/(0.5*rho*VtracMin^2*s*cos(phi));
alfaTracMin = fsolve(@(alfa) CL(alfa) - CLTracMin,0.5,options)

% Deflexão de profundor
deflexProfundTracMin = fsolve(@(delta) CM(alfaTracMin,delta),0.5,options)

% Posição de manete
PosicManeteTracMin = fsolve(@(delta) T(delta,rho)-TracMinTeo,10^5,options)

%% Item 3
poli = [0.5*rho*s*Cd0 0 (-(rho/1.225)^0.6*Tmax_s) 0 2*k*W^2/(rho*s*cos(phi)^2)];
VMaxMin = sort(roots(poli),'descend');
Vmin = VMaxMin(2,1);
Vmax = VMaxMin(1,1)

% raio de curva
Rvmax = Vmax^2/(9.81*tan(phi))

% velocidade angular
OmegaVmax = Vmax/Rvmax

% período necessário
PeriodVmax = 2*pi/OmegaVmax

% angulo de ataque
CLVelMax = W/(0.5*rho*Vmax^2*s*cos(phi));
alfaVelMax = fsolve(@(alfa) CL(alfa) - CLVelMax,0.5,options)

% Deflexão de profundor
deflexProfundVelMax = fsolve(@(delta)CM(alfaVelMax,delta),0.5,options)

%% Item 4

Vstall = sqrt(2*W/(rho*s*CLmax));

if Vmin < Vstall
    Vmin = Vstall;
end

Vmin 

% raio de curva
Rvmin = Vmin^2/(9.81*tan(phi))

% velocidade angular
OmegaVmin = Vmin/Rvmin

% período necessário
PeriodVmin = 2*pi/OmegaVmin

% angulo de ataque
CLVelMin = W/(0.5*rho*Vmin^2*s*cos(phi));
alfaVelMin = fsolve(@(alfa) CL(alfa) - CLVelMin,0.5,options)

% Deflexão de profundor
deflexProfundVelMin = fsolve(@(delta)CM(alfaVelMin,delta),0.5,options)

%% Item 5

TetoVoo = @(rhoTeto) 2*W*sqrt(Cd0*k)/cos(phi) - T(1,rhoTeto);

rhoTeto = fsolve(TetoVoo, 0.1,options);

HtetoAux = 12000:.05:15000;
[~,~,~,rhoTetoAux] = atmosisa(HtetoAux);
rhoTetoAuxPosic = find(abs(rhoTetoAux - rhoTeto) < 10^-4);
Hteto = HtetoAux(rhoTetoAuxPosic(1,1))
clear HtetoAux rhoTetoAux rhoTetoAuxPosic

%% Item 6
HEnvel = linspace(0,0.9999*Hteto,100);
[~,~,~,rhoEnvel] = atmosisa(HEnvel);
rhoEnvel = rhoEnvel';


PoliVreq = [0.5*rhoEnvel*s*Cd0, zeros(length(rhoEnvel),1),  (- T(1,rhoEnvel)), zeros(length(rhoEnvel),1), 2*k*W^2./(rhoEnvel*s*cos(phi)^2)];

Vreq = zeros(length(rhoEnvel),1);
Vreq2 = zeros(length(rhoEnvel),1);

for i = 1:length(rhoEnvel)
VreqAux = sort(roots(PoliVreq(i,:)),'descend');
Vreq(i) = VreqAux(1,1);
Vreq2(i) = VreqAux(2,1);
end

HEnvel = [ HEnvel HEnvel(sort(1:1:length(HEnvel),'descend'))];
Vreq = [ (Vreq2)' (Vreq(sort(1:1:length(Vreq),'descend')))' ];
Vstall = sqrt(2*W./(rhoEnvel*s*CLmax));


color = HEnvel;

figure
patch(Vreq,HEnvel,color)
hold on
colorbar
plot(Vstall, HEnvel(1,1:100),'LineWidth',2)
xlabel('Velocidade [m/s]')
ylabel('Altitude da aeronave [m]')
title('Envelope de voo da aeronave')
grid on
hold off

%% Item 7

Vel = linspace(0,VmaxOper,1000);


[~,~,~,rho] = atmosisa(3000);

%limite do cosseno:
cosMax = 1*ones(1,length(Vel));

%limite de velocidade:
Vstall = sqrt(2*W/(rho*s*CLmax))*ones(1,length(Vel));

%limite estrutural: 
cosPhiMaxEstrutural = (1/nmax)*ones(1,length(Vel));

%limite aerodinâmico:
cosPhiMaxAerodinamico = 2*W./(rho.*Vel.^2*s*CLmax).*(2*W./(rho.*Vel.^2*s*CLmax)<1); %a desigualdade limita a valor do cosseno entre 0 e 1

%limite propulsivo:
cosPhiMaxPropulsivo = (2*k*W^2./(2*Vel.^2*s))./(-0.5*rho.*Vel.^2*s*Cd0 + T(1,rho)).*((2*k*W^2./(2*Vel.^2*s))./(-0.5*rho.*Vel.^2*s*Cd0 + T(1,rho))<1); %a desigualdade limita a valor do cosseno entre 0 e 1

m1 = min(find(cosPhiMaxEstrutural>0)); %Remove os zeros que existem repetidos no vetor

m2 = min(find(cosPhiMaxAerodinamico>0));

m3 = min(find(cosPhiMaxPropulsivo>0));

figure
plot(Vel,cosMax,'REPLACE_WITH_DASH_DASHr')
hold on
grid on
plot(Vel(1,m1:end),cosPhiMaxEstrutural(1,m1:end))
plot(Vel(1,m2:end),cosPhiMaxAerodinamico(1,m2:end))
plot(Vel(1,m3:end),cosPhiMaxPropulsivo(1,m3:end))
plot(Vstall,linspace(0,1,length(Vstall)),'REPLACE_WITH_DASH_DASHk')
text(76.15,0.5,'\leftarrow Ponto de raio minimo')
plot(76.15,0.5,'or')
text(150,0.7,'Região permitida')
hold off
ylim([0 1.1])
xlabel('Velocidade [m/s]')
ylabel('cos(\phi)')
title('Gráfico da Tração requerida numa dada velocidade');
legend('Limite do cosseno','Limite estrutural', 'Limite aerodinâmico', 'Limite propulsivo','Velocidade de estol');


VRaioMin = 76.15;
phiRaioMin = acos(0.5);
Rmin = VRaioMin^2/(9.81*tan(phiRaioMin))

%% Gera a versão html do código
%     publish('Lab3.m');
%     web('html/Lab3.html');

##### SOURCE END #####
--></body></html>